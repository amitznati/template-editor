module.exports=function(r){var n={};function o(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=r,o.c=n,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=1)}([function(t,e,r){},function(t,e,r){"use strict";r.r(e);r(0);var F=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},i=window.cancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)},n=Array.prototype.forEach,o=Array.prototype.slice,a=Array.prototype.map,s=Array.prototype.reduce,At=console.warn;function I(t){return null!=t}function q(t){return null==t}function h(t){return"function"==typeof t}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function a(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),!I(t))throw new Error("Passed parameter must be selector/element/elementArray");if("string"==typeof t){var e=document.querySelectorAll(t);this.length=e.length;for(var r=0;r<this.length;r++)this[r]=e[r]}else if(1===t.nodeType||t===document)this[0]=t,this.length=1;else if(t instanceof a||"object"===c(t)){this.length=t.length;for(var n=0;n<this.length;n++)this[n]=t[n]}else if(Array.isArray(t))for(var o=this.length=0;o<this.length;o++)1===t.nodeType&&(this[o]=t[o],this.length++)}return function(t,e,r){e&&u(t.prototype,e),r&&u(t,r)}(a,[{key:"css",value:function(r){var t={setStyle:function(t){return function(t,e){for(var r=t.length;r--;)for(var n in e)t[r].style[n]=e[n];return t.style}(this,t)},getStyle:function(){return function(t){for(var e=t.length;e--;)return t[e].currentStyle?t[e].currentStyle[r]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t[e],"")[r]:t[e].style[r]}(this)}};return"string"==typeof r?t.getStyle.apply(this,o.call(arguments,1)):"object"!==c(r)&&r?(At("Method ".concat(r," does not exist")),!1):t.setStyle.apply(this,arguments)}},{key:"find",value:function(t){for(var e=this.length;e--;)return U(this[e].querySelectorAll(t))}},{key:"each",value:function(t){for(var e,r=o.call(this,0),n=r.length-1;0<=n;--n)e=n,t.call(r[e]);return this}},{key:"on",value:function(t,e,r,n){for(var o=this.length;o--;)this[o].events||(this[o].events={},this[o].events[t]=[]),2===arguments.length?document.addEventListener?this[o].addEventListener(t,e,!1):document.attachEvent?this[o].attachEvent("on".concat(t),e):this[o]["on".concat(t)]=e:3===arguments.length&&"string"==typeof e&&f(this[o],t,e,r,n,!0);return this}},{key:"off",value:function(t,e,r,n){for(var o=this.length;o--;)this[o].events||(this[o].events={},this[o].events[t]=[]),2===arguments.length?document.removeEventListener?this[o].removeEventListener(t,e,!1):document.detachEvent?this[o].detachEvent("on".concat(t),e):this[o]["on".concat(t)]=null:3===arguments.length&&"string"==typeof e&&f(this[o],t,e,r,n,!1);return this}},{key:"is",value:function(t){for(var e=U(t),r=this.length;r--;)if(this[r]===e[r])return!0;return!1}}]),a}();function f(t,e,r,n,o,a){function i(t){for(var e=t.target;e&&e!==this;)e.matches(r)&&n.call(e,t),e=e.parentNode}!0===a?document.addEventListener?t.addEventListener(e,i,o||!1):document.attachEvent?t.attachEvent("on".concat(e),i):t["on".concat(e)]=i:document.removeEventListener?t.removeEventListener(e,i,o||!1):document.detachEvent?t.detachEvent("on".concat(e),i):t["on".concat(e)]=null}function U(t){return new l(t)}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.observers={}}return function(t,e,r){e&&p(t.prototype,e),r&&p(t,r)}(t,[{key:"subscribe",value:function(t,e){var r=this.observers;return q(r[t])&&Object.defineProperty(r,t,{value:[]}),r[t].push(e),this}},{key:"unsubscribe",value:function(t,e){var r=this.observers;if(I(r[t])){var n=r[t].indexOf(e);r[t].splice(n,1)}return this}},{key:"notify",value:function(e,r,n){q(this.observers[e])||this.observers[e].forEach(function(t){if(r!==t)switch(e){case"onmove":t.notifyMove(n);break;case"onrotate":t.notifyRotate(n);break;case"onresize":t.notifyResize(n);break;case"onapply":t.notifyApply(n);break;case"ongetstate":t.notifyGetState(n)}})}}]),t}();function V(t){return t.getBoundingClientRect()}function P(t){return t.css("-webkit-transform")||t.css("-moz-transform")||t.css("-ms-transform")||t.css("-o-transform")||t.css("transform")||"none"}function C(t){var e=t.match(/-?\d+\.?\d+|-?\d+/g);return e?e.map(function(t){return parseFloat(t)}):[1,0,0,1,0,0]}function G(e,t){if(t){if(e.classList){if(!(-1<t.indexOf(" ")))return e.classList.add(t);t.split(/\s+/).forEach(function(t){return e.classList.add(t)})}return e}}function R(e,t){if(t){if(e.classList){if(!(-1<t.indexOf(" ")))return e.classList.remove(t);t.split(/\s+/).forEach(function(t){return e.classList.remove(t)})}return e}}var H=Math.PI/180;Math.PI;function Q(t,e){if(0===e)return t;var r=function(t,e){return 0===e?t:Math.round(t/e)*e}(t,e);return r-t<e?r:void 0}function D(t,e,r,n,o,a,i){var s=parseFloat(r)/2,c=parseFloat(n)/2,u=t+s,l=e+c,h=t-u,f=e-l,p=Math.atan2(f,h)+o,y=Math.sqrt(Math.pow(s,2)+Math.pow(c,2)),v=Math.cos(p),d=Math.sin(p),b=l+y*(d=!0===i?-d:d);return{left:Ot(u+y*(v=!0===a?-v:v)),top:Ot(b)}}function Ot(t,e){var r=1<arguments.length&&void 0!==e?e:6;return Number(t.toFixed(r))}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(t){v(e,t,r[t])})}return e}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var b=function(){function r(t,e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.constructor===r)throw new TypeError("Cannot construct Subject instances directly");this.el=t,this.storage=null,this.proxyMethods=null,this.observable=e,this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._animate=this._animate.bind(this)}return function(t,e,r){e&&d(t.prototype,e),r&&d(t,r)}(r,[{key:"enable",value:function(t){q(this.storage)?(this._processOptions(t),this._init(this.el)):At("Already enabled")}},{key:"disable",value:function(){var t=this.storage,e=this.proxyMethods,r=this.el;q(t)||(t.onExecution&&(this._end(),U(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp).off("touchmove",this._onTouchMove).off("touchend",this._onTouchEnd)),R(r,"sjx-drag"),this._destroy(),this.unsubscribe(),e.onDestroy.call(this,r),delete this.storage)}},{key:"_init",value:function(){}},{key:"_destroy",value:function(){}},{key:"_cursorPoint",value:function(){}},{key:"_drag",value:function(){var t;this._processMove.apply(this,arguments),(t=this.proxyMethods.onMove).call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_rotate",value:function(){var t;this._processRotate.apply(this,arguments),(t=this.proxyMethods.onRotate).call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_resize",value:function(){var t;this._processResize.apply(this,arguments),(t=this.proxyMethods.onResize).call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_processOptions",value:function(t){var e=this.el;G(e,"sjx-drag");var r={x:10,y:10,angle:10*H},n={move:!1,resize:!1,rotate:!1},o=null,a=!1,i="xy",s="auto",c="auto",u="auto",l="#00a8ff",h=!1,f=function(){},p=function(){},y=function(){},v=function(){},d=function(){},b=function(){},m=e.parentNode;if(I(t)){var x=t.snap,g=t.each,_=t.axis,w=t.cursorMove,M=t.cursorResize,k=t.cursorRotate,j=t.rotationPoint,T=t.restrict,S=t.onInit,E=t.onDrop,A=t.onMove,O=t.onResize,V=t.onRotate,P=t.onDestroy,C=t.container,R=t.proportions,D=t.themeColor;if(I(x)){var z=x.x,N=x.y,X=x.angle;r.x=q(z)?10:z,r.y=q(N)?10:N,r.angle=q(X)?r.angle:X*H}if(I(g)){var Y=g.move,B=g.resize,L=g.rotate;n.move=Y||!1,n.resize=B||!1,n.rotate=L||!1}I(T)&&(o="parent"===T?e.parentNode:U(T)[0]||document),l=D||"#00a8ff",s=w||"auto",c=M||"auto",u=k||"auto",i=_||"xy",m=I(C)&&U(C)[0]?U(C)[0]:m,h=j||!1,a=R||!1,f=Z(S),d=Z(E),p=Z(A),v=Z(O),y=Z(V),b=Z(P),f.call(this,e)}this.options={axis:i,themeColor:l,cursorMove:s,cursorRotate:u,cursorResize:c,rotationPoint:h,restrict:o,container:m,snap:r,each:n,proportions:a},this.proxyMethods={onInit:f,onDrop:d,onMove:p,onResize:v,onRotate:y,onDestroy:b},this.subscribe(n)}},{key:"_draw",value:function(){this._animate()}},{key:"_animate",value:function(){var t=this,e=t.observable,r=t.storage,n=t.options;if(!q(r)&&(r.frame=F(t._animate),r.doDraw)){r.doDraw=!1;var o=r.dox,a=r.doy,i=r.clientX,s=r.clientY,c=r.doDrag,u=r.doResize,l=r.doRotate,h=r.doSetCenter,f=r.revX,p=r.revY,y=n.snap,v=n.each,d=n.restrict,b=v.move,m=v.resize,x=v.rotate;if(u){var g=r.transform,_=r.cx,w=r.cy,M=this._pointToElement({x:i,y:s}),k=M.x,j=M.y,T=o?Q(k-_,y.x/g.scX):0,S=a?Q(j-w,y.y/g.scY):0;T=o?f?-T:T:0,S=a?p?-S:S:0,t._resize(T,S),m&&e.notify("onresize",t,{dx:T,dy:S})}if(c){var E=r.restrictOffset,A=r.elementOffset,O=r.nx,V=r.ny;I(d)&&(i-E.left<O-A.left&&(i=O-A.left+E.left),s-E.top<V-A.top&&(s=V-A.top+E.top));var P=o?Q(i-O,y.x):0,C=a?Q(s-V,y.y):0;t._drag(P,C),b&&e.notify("onmove",t,{dx:P,dy:C})}if(l){var R=r.pressang,D=r.center,z=Math.atan2(s-D.y,i-D.x)-R;t._rotate(Q(z,y.angle)),x&&e.notify("onrotate",t,{radians:z})}if(h){var N=r.bx,X=r.by,Y=this._pointToControls({x:i,y:s}),B=Y.x,L=Y.y;t._moveCenterHandle(B-N,L-X)}}}},{key:"_start",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.observable,r=this.storage,n=this.options,o=this.el,a=this._compute(t);Object.keys(a).forEach(function(t){r[t]=a[t]});var i=a.onRightEdge,s=a.onBottomEdge,c=a.onTopEdge,u=a.onLeftEdge,l=a.handle,h=a.factor,f=a.revX,p=a.revY,y=i||s||c||u,v=r.handles,d=r.radius,b=n.axis,m=n.restrict;I(d)&&R(d,"sjx-hidden");var x=l.is(v.rotator),g=!!I(v.center)&&l.is(v.center),_=t.clientX,w=t.clientY,M=this._cursorPoint({clientX:_,clientY:w}),k=M.x,j=M.y,T=this._pointToElement({x:k,y:j}),S=T.x,E=T.y,A=this._pointToControls({x:k,y:j}),O={clientX:_,clientY:w,nx:k,ny:j,cx:S,cy:E,bx:A.x,by:A.y,doResize:y,doDrag:!(x||y||g),doRotate:x,doSetCenter:g,onExecution:!0,cursor:null,elementOffset:V(o),restrictOffset:I(m)?V(m):null,dox:/\x/.test(b)&&(!y||(l.is(v.ml)||l.is(v.mr)||l.is(v.tl)||l.is(v.tr)||l.is(v.bl)||l.is(v.br))),doy:/\y/.test(b)&&(!y||(l.is(v.br)||l.is(v.bl)||l.is(v.bc)||l.is(v.tr)||l.is(v.tl)||l.is(v.tc)))};this.storage=z({},r,O),e.notify("ongetstate",this,{factor:h,revX:f,revY:p}),this._draw()}},{key:"_moving",value:function(t){t.preventDefault&&t.preventDefault();var e=this.storage,r=this.options,n=this._cursorPoint(t),o=n.x,a=n.y;e.e=t,e.clientX=o,e.clientY=a,e.doDraw=!0;var i=e.doRotate,s=e.doDrag,c=e.doResize,u=e.cursor,l=r.cursorMove,h=r.cursorResize,f=r.cursorRotate;q(u)&&(s?u=l:i?u=f:c&&(u=h),U(document.body).css({cursor:u}))}},{key:"_end",value:function(t){I(t)&&t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.observable,r=this.storage,n=this.proxyMethods,o=this.el,a=r.doResize?"resize":r.doDrag?"drag":"rotate";r.doResize=!1,r.doDrag=!1,r.doRotate=!1,r.doSetCenter=!1,r.doDraw=!1,r.onExecution=!1,r.cursor=null,this._apply(a),e.notify("onapply",this,a),i(r.frame),n.onDrop.call(this,t,o),U(document.body).css({cursor:"auto"}),I(r.radius)&&G(r.radius,"sjx-hidden")}},{key:"_onMouseDown",value:function(t){this._start(t),U(document).on("mousemove",this._onMouseMove).on("mouseup",this._onMouseUp)}},{key:"_onTouchStart",value:function(t){this._start(t.touches[0]),U(document).on("touchmove",this._onTouchMove).on("touchend",this._onTouchEnd)}},{key:"_onMouseMove",value:function(t){this._moving(t,this.el)}},{key:"_onTouchMove",value:function(t){this._moving(t.touches[0],this.el)}},{key:"_onMouseUp",value:function(t){U(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp),this._end(t,this.el)}},{key:"_onTouchEnd",value:function(t){U(document).off("touchmove",this._onTouchMove).off("touchend",this._onTouchEnd),0===t.touches.length&&this._end(t.changedTouches[0],this.el)}},{key:"notifyMove",value:function(t){var e=t.dx,r=t.dy;this._drag(e,r)}},{key:"notifyRotate",value:function(t){var e=this.options.snap;this._rotate(Q(t.radians,e.angle))}},{key:"notifyResize",value:function(t){var e=t.dx,r=t.dy,n=t.dox,o=t.doy;this._resize(e,r,n,o)}},{key:"notifyApply",value:function(t){this._apply(t)}},{key:"notifyGetState",value:function(t){var e=this.storage,r=this._getState(t);this.storage=z({},e,r)}},{key:"subscribe",value:function(t){var e=this.observable,r=t.resize,n=t.move,o=t.rotate;(n||r||o)&&e.subscribe("ongetstate",this).subscribe("onapply",this),n&&e.subscribe("onmove",this),r&&e.subscribe("onresize",this),o&&e.subscribe("onrotate",this)}},{key:"unsubscribe",value:function(){this.observable.unsubscribe("ongetstate",this).unsubscribe("onapply",this).unsubscribe("onmove",this).unsubscribe("onresize",this).unsubscribe("onrotate",this)}}]),r}();function Z(t){return h(t)?function(){t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}:function(){}}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e){return!e||"object"!==x(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var j=function(){function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=w(this,M(o).call(this,t,r))).enable(e),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(o,b),function(t,e,r){e&&g(t.prototype,e),r&&g(t,r)}(o,[{key:"_init",value:function(t){var e=document.createElement("div");G(e,"sjx-wrapper"),t.parentNode.insertBefore(e,t);var r=U(t),n=this.options.rotationPoint,o=t.style,a=o.left,i=o.top,s=o.width,c=o.height,u=s||r.css("width"),l=c||r.css("height"),h=i||r.css("top"),f=a||r.css("left"),p=U(e.parentNode),y={top:h,left:f,width:u,height:l,transform:P(r)},v=document.createElement("div"),d={normal:["sjx-hdl","sjx-normal"],tl:["sjx-hdl","sjx-hdl-t","sjx-hdl-l","sjx-hdl-tl"],tr:["sjx-hdl","sjx-hdl-t","sjx-hdl-r","sjx-hdl-tr"],br:["sjx-hdl","sjx-hdl-b","sjx-hdl-r","sjx-hdl-br"],bl:["sjx-hdl","sjx-hdl-b","sjx-hdl-l","sjx-hdl-bl"],tc:["sjx-hdl","sjx-hdl-t","sjx-hdl-c","sjx-hdl-tc"],bc:["sjx-hdl","sjx-hdl-b","sjx-hdl-c","sjx-hdl-bc"],ml:["sjx-hdl","sjx-hdl-m","sjx-hdl-l","sjx-hdl-ml"],mr:["sjx-hdl","sjx-hdl-m","sjx-hdl-r","sjx-hdl-mr"],center:n?["sjx-hdl","sjx-hdl-m","sjx-hdl-c","sjx-hdl-mc"]:void 0,rotator:["sjx-hdl","sjx-hdl-m","sjx-rotator"]};Object.keys(d).forEach(function(t){var e=d[t];if(!q(e)){var r=function(t){var e=document.createElement("div");return t.forEach(function(t){G(e,t)}),e}(e);d[t]=r,v.appendChild(r)}}),I(d.center)&&U(d.center).css({left:"".concat(t.getAttribute("data-cx"),"px"),top:"".concat(t.getAttribute("data-cy"),"px"),"border-color":"rgb(254, 50, 50)","background-color":"rgb(254, 50, 50, 0.2)"});G(v,"sjx-controls"),e.appendChild(v);var b=U(v);b.css(y);var m=U(e);this.storage={controls:v,handles:d,radius:m.find(".sjx-radius"),parent:p},b.on("mousedown",this._onMouseDown).on("touchstart",this._onTouchStart)}},{key:"_destroy",value:function(){var t=this.storage.controls;U(t).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart);var e=t.parentNode;e.parentNode.removeChild(e)}},{key:"_compute",value:function(t){var e=this.storage.handles,r=U(t.target),n=r.is(e.tl)||r.is(e.ml)||r.is(e.bl)||r.is(e.tc),o=r.is(e.tl)||r.is(e.tr)||r.is(e.tc)||r.is(e.ml),a=r.is(e.tl)||r.is(e.tc)||r.is(e.tr),i=r.is(e.tl)||r.is(e.ml)||r.is(e.bl),s=r.is(e.tr)||r.is(e.mr)||r.is(e.br),c=r.is(e.br)||r.is(e.bc)||r.is(e.bl),u=r.is(e.tr)||r.is(e.bl)?-1:1,l=this._getState({factor:u,revX:n,revY:o}),h=this._cursorPoint(t),f=h.x,p=h.y,y=Math.atan2(p-l.center.y,f-l.center.x);return l.onTopEdge=a,l.onLeftEdge=i,l.onRightEdge=s,l.onBottomEdge=c,l.handle=r,l.pressang=y,l}},{key:"_pointToElement",value:function(t){var e=this.storage.transform,r=t.x,n=t.y,o=_(e.matrix);return o[4]=o[5]=0,this._applyMatrixToPoint(E(o),r,n)}},{key:"_pointToControls",value:function(t){return this._pointToElement(t)}},{key:"_applyMatrixToPoint",value:function(t,e,r){return S({x:e,y:r},t)}},{key:"_cursorPoint",value:function(t){var e=C(P(U(this.options.container)));return S({x:t.clientX,y:t.clientY},E(e))}},{key:"_apply",value:function(){var t=this.el,e=this.storage,r=U(t),n=e.cached,o=e.controls,a=e.transform,i=e.handles,s=U(o),c=parseFloat(s.css("width"))/2,u=parseFloat(s.css("height"))/2,l=i.center,h=I(l),f=h?parseFloat(U(l).css("left")):c,p=h?parseFloat(U(l).css("top")):u;if(t.setAttribute("data-cx",f),t.setAttribute("data-cy",p),!q(n)){var y=n.dx,v=n.dy,d=T(a.matrix),b=parseFloat(t.style.left||r.css("left")),m=parseFloat(t.style.top||r.css("top"));d.left="".concat(b+y,"px"),d.top="".concat(m+v,"px"),r.css(d),s.css(d),this.storage.cached=null}}},{key:"_processResize",value:function(t,e){var r=this.el,n=this.storage,o=this.options.proportions,a=n.controls,i=n.coords,s=n.cw,c=n.ch,u=n.transform,l=n.refang,h=n.revX,f=n.revY,p=(s+t)/s,y=o?s*p:s+t,v=o?c*p:c+e;if(!(y<2||v<2)){var d=_(u.matrix),b=D(d[4],d[5],y,v,l,h,f),m=i.left-b.left,x=i.top-b.top;d[4]+=m,d[5]+=x;var g=T(d);g.width="".concat(y,"px"),g.height="".concat(v,"px"),U(a).css(g),U(r).css(g),n.cached={dx:m,dy:x}}}},{key:"_processMove",value:function(t,e){var r=this.el,n=this.storage,o=n.controls,a=n.transform,i=a.matrix,s=_(a.parentMatrix);s[4]=s[5]=0;var c=_(i);c[4]=i[4]+t,c[5]=i[5]+e;var u=T(c);U(o).css(u),U(r).css(u),n.cached={dx:t,dy:e}}},{key:"_processRotate",value:function(t){var e=this.el,r=this.storage,n=r.controls,o=r.transform,a=r.center,i=o.matrix,s=o.parentMatrix,c=Ot(Math.cos(t)),u=Ot(Math.sin(t)),l=[1,0,0,1,a.cx,a.cy],h=[c,u,-u,c,0,0],f=_(s);f[4]=f[5]=0;var p=T(N(N(N(l,N(E(f),N(h,f))),E(l)),i));U(n).css(p),U(e).css(p)}},{key:"_getState",value:function(t){var e=t.factor,r=t.revX,n=t.revY,o=this.el,a=this.storage,i=this.options.container,s=a.handles,c=a.controls,u=a.parent,l=s.center,h=s.tl,f=s.tr,p=V(h),y=V(f),v=Math.atan2(y.top-p.top,y.left-p.left)*e,d=U(c),b=C(P(U(i))),m=C(P(U(c))),x=C(P(u)),g={matrix:m,parentMatrix:u===i?N(x,b):b,scX:Math.sqrt(m[0]*m[0]+m[1]*m[1]),scY:Math.sqrt(m[2]*m[2]+m[3]*m[3])},_=parseFloat(d.css("width")),w=parseFloat(d.css("height")),M=D(g.matrix[4],g.matrix[5],_,w,v,r,n),k=_/2,j=w/2,T=V(o),S=I(l),E=S?parseFloat(U(l).css("left")):k,A=S?parseFloat(U(l).css("top")):j,O=S?7:0;return{transform:g,cw:_,ch:w,coords:M,center:{x:T.left+E-O,y:T.top+A-O,cx:k-E-O,cy:j-A-O,hx:E,hy:A},factor:e,refang:v,revX:r,revY:n}}},{key:"_moveCenterHandle",value:function(t,e){var r=this.storage,n=r.handles,o=r.center,a="".concat(o.hx+t,"px"),i="".concat(o.hy+e,"px");U(n.center).css({left:a,top:i})}},{key:"resetCenterPoint",value:function(){U(this.storage.handles.center).css({left:null,top:null})}},{key:"controls",get:function(){return this.storage.controls}}]),o}();function T(t){var e="matrix(".concat(t.join(),")");return{transform:e,webkitTranform:e,mozTransform:e,msTransform:e,otransform:e}}function S(t,e){var r=t.x,n=t.y,o=m(e,6),a=o[0],i=o[1],s=o[2],c=o[3];return{x:a*r+s*n+o[4],y:i*r+c*n+o[5]}}function E(t){var e=[[t[0],t[2],t[4]],[t[1],t[3],t[5]],[0,0,1]];if(e.length===e[0].length){for(var r=e.length,n=[],o=[],a=0;a<r;a+=1){n[n.length]=[],o[o.length]=[];for(var i=0;i<r;i+=1)n[a][i]=a==i?1:0,o[a][i]=e[a][i]}for(var s=0;s<r;s+=1){var c=o[s][s];if(0===c){for(var u=s+1;u<r;u+=1)if(0!==o[u][s]){for(var l=0;l<r;l++)c=o[s][l],o[s][l]=o[u][l],o[u][l]=c,c=n[s][l],n[s][l]=n[u][l],n[u][l]=c;break}if(0===(c=o[s][s]))return}for(var h=0;h<r;h++)o[s][h]=o[s][h]/c,n[s][h]=n[s][h]/c;for(var f=0;f<r;f++)if(f!=s){c=o[f][s];for(var p=0;p<r;p++)o[f][p]-=c*o[s][p],n[f][p]-=c*n[s][p]}}return[n[0][0],n[1][0],n[0][1],n[1][1],n[0][2],n[1][2]]}}function N(t,e){for(var r=[[t[0],t[2],t[4]],[t[1],t[3],t[5]],[0,0,1]],n=[[e[0],e[2],e[4]],[e[1],e[3],e[5]],[0,0,1]],o=[],a=0;a<n.length;a++){o[a]=[];for(var i=0;i<r[0].length;i++){for(var s=0,c=0;c<r.length;c++)s+=r[c][i]*n[a][c];o[a].push(s)}}return[o[0][0],o[1][0],o[0][1],o[1][1],o[0][2],o[1][2]]}var A=["circle","ellipse","image","line","path","polygon","polyline","rect","text","g"];function O(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function rt(){return O("svg").createSVGMatrix()}function nt(t,e){return(e.getScreenCTM()||rt()).inverse().multiply(t.getScreenCTM()||rt())}function X(t){return"matrix(".concat(t.a,",").concat(t.b,",").concat(t.c,",").concat(t.d,",").concat(t.e,",").concat(t.f,")")}function Vt(t,e,r,n){var o=e.createSVGPoint();return o.x=r,o.y=n,o.matrixTransform(t)}function Pt(t){var e=rt();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}function $(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ct(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Y=/\s*([achlmqstvz])([^achlmqstvz]*)\s*/gi,B=/\s*,\s*|\s+/g;function Rt(t){for(var e=Y.lastIndex=0,r=[];e=Y.exec(t);){var n=e[1],o=n.toUpperCase(),a=e[2].replace(/([^e])-/g,"$1 -").replace(/ +/g," ");r.push({relative:n!==o,key:o,cmd:n,values:a.trim().split(B).map(function(t){if(!isNaN(t))return Number(t)})})}return r}function L(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function W(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ot=/[+-]?\d+(\.\d+)?/g,at=function(){function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=W(this,tt(o).call(this,t,r))).enable(e),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(o,b),function(t,e,r){e&&K(t.prototype,e),r&&K(t,r)}(o,[{key:"_init",value:function(t){var e=this.options,r=e.rotationPoint,n=e.container,a=e.themeColor,o=O("g");n.appendChild(o);var i=t.getBBox(),s=i.width,c=i.height,u=i.x,l=i.y,h=nt(t,n),f=O("rect");[["width",s],["height",c],["x",u],["y",l],["fill",a],["fill-opacity",.2],["stroke",a],["stroke-dasharray","3 3"],["vector-effect","non-scaling-stroke"],["transform",X(h)]].forEach(function(t){f.setAttribute(t[0],t[1])});var p=O("g"),y=O("g"),v=O("g");v.appendChild(f),o.appendChild(v),o.appendChild(y),o.appendChild(p);var d=f.getBBox(),b=d.x,m=d.y,x=d.width,g=d.height,_=t.getAttribute("data-cx"),w=t.getAttribute("data-cy"),M=nt(f,f.parentNode),k=Vt(M,n,b+x/2,m+g/2),j={tl:Vt(M,n,b,m),tr:Vt(M,n,b+x,m),br:Vt(M,n,b+x,m+g),bl:Vt(M,n,b,m+g),tc:Vt(M,n,b+x/2,m),bc:Vt(M,n,b+x/2,m+g),ml:Vt(M,n,b,m+g/2),mr:Vt(M,n,b+x,m+g/2),center:r?function(t,e,r){if(q(e)||q(r))return null;var n=t.createSVGPoint();return n.x=e,n.y=r,n}(n,_,w)||k:void 0,rotator:{}},T=Math.atan2(j.tl.y-j.tr.y,j.tl.x-j.tr.x);j.rotator.x=j.mr.x-50*Math.cos(T),j.rotator.y=j.mr.y-50*Math.sin(T);var S=O("line");S.x1.baseVal.value=j.mr.x,S.y1.baseVal.value=j.mr.y,S.x2.baseVal.value=j.rotator.x,S.y2.baseVal.value=j.rotator.y,ft(S,a),y.appendChild(S);var E=null;r&&(G(E=O("line"),"sjx-hidden"),E.x1.baseVal.value=k.x,E.y1.baseVal.value=k.y,E.x2.baseVal.value=_||k.x,E.y2.baseVal.value=w||k.y,ft(E,"#fe3232"),E.setAttribute("opacity",.5),y.appendChild(E)),Object.keys(j).forEach(function(t){var e=j[t];if(!q(e)){var r=e.x,n=e.y,o="center"===t?"#fe3232":a;j[t]=function(t,e,r){var n=O("circle");G(n,"sjx-svg-hdl");var o={cx:t,cy:e,r:5,fill:r,stroke:r,"fill-opacity":.2,"vector-effect":"non-scaling-stroke","stroke-width":2};return Object.keys(o).map(function(t){n.setAttribute(t,o[t])}),n}(r,n,o),p.appendChild(j[t])}}),this.storage={wrapper:o,box:f,handles:j,normalLine:S,radius:r?E:void 0,parent:t.parentNode},U(o).on("mousedown",this._onMouseDown).on("touchstart",this._onTouchStart)}},{key:"_destroy",value:function(){var t=this.storage.wrapper;U(t).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart),t.parentNode.removeChild(t)}},{key:"_compute",value:function(t){var e=this.storage.handles,r=U(t.target),n=r.is(e.tl)||r.is(e.ml)||r.is(e.bl)||r.is(e.tc),o=r.is(e.tl)||r.is(e.tr)||r.is(e.tc)||r.is(e.ml),a=r.is(e.tl)||r.is(e.tc)||r.is(e.tr),i=r.is(e.tl)||r.is(e.ml)||r.is(e.bl),s=r.is(e.tr)||r.is(e.mr)||r.is(e.br),c=r.is(e.br)||r.is(e.bc)||r.is(e.bl),u=this._getState({revX:n,revY:o}),l=this._cursorPoint(t),h=l.x,f=l.y,p=Math.atan2(f-u.center.y,h-u.center.x);return u.onTopEdge=a,u.onLeftEdge=i,u.onRightEdge=s,u.onBottomEdge=c,u.handle=r,u.pressang=p,u}},{key:"_cursorPoint",value:function(t){var e=this.options.container;return Vt(e.getScreenCTM().inverse(),e,t.clientX,t.clientY)}},{key:"_pointToElement",value:function(t){var e=this.storage.transform,r=t.x,n=t.y,o=e.ctm.inverse();return o.e=o.f=0,this._applyMatrixToPoint(o,r,n)}},{key:"_pointToControls",value:function(t){var e=this.storage.transform,r=t.x,n=t.y,o=e.boxCTM.inverse();return o.e=o.f=0,this._applyMatrixToPoint(o,r,n)}},{key:"_applyMatrixToPoint",value:function(t,e,r){var n=this.options.container.createSVGPoint();return n.x=e,n.y=r,n.matrixTransform(t)}},{key:"_apply",value:function(t){var i=this.el,e=this.storage,s=this.options.container,r=e.box,n=e.handles,o=e.cached,a=e.transform,c=a.matrix,u=i.getBBox(),l=u.x,h=u.y,f=u.width,p=u.height,y=I(n.center)?Vt(a.boxCTM,s,n.center.cx.baseVal.value,n.center.cy.baseVal.value):Vt(c,s,l+f/2,h+p/2);if(i.setAttribute("data-cx",y.x),i.setAttribute("data-cy",y.y),!q(o)){var v=o.scaleX,d=o.scaleY,b=o.dx,m=o.dy,x=o.ox,g=o.oy;if("drag"===t){if(0===b&&0===m)return;var _=rt();_.e=b,_.f=m;var w=_.multiply(c).multiply(_.inverse());if(i.setAttribute("transform",X(w)),ut(i))lt(i).forEach(function(t){var e=s.createSVGPoint(),r=nt(i.parentNode,s).inverse();e.x=x,e.y=g,r.e=r.f=0;var n=e.matrixTransform(r),o=rt();o.e=b,o.f=m;var a=o.multiply(nt(t,t.parentNode)).multiply(o.inverse());!function(t){return 1===t.a&&0===t.b&&0===t.c&&1===t.d&&0===t.e&&0===t.f}(a)&&t.setAttribute("transform",X(a)),ut(t)||it(t,{x:n.x,y:n.y})});else it(i,{x:b,y:m})}if("resize"===t){var M=r.getBBox(),k=M.x,j=M.y,T=M.width,S=M.height;if(ct(e,{x:k,y:j,width:T,height:S},s),ut(i))lt(i).forEach(function(t){ut(t)||st(t,{scaleX:v,scaleY:d,defaultCTM:t.__ctm__,bBox:a.bBox,container:s,storage:e})});else st(i,{scaleX:v,scaleY:d,defaultCTM:a.ctm,bBox:a.bBox,container:s,storage:e});i.setAttribute("transform",X(c))}this.storage.cached=null}}},{key:"_processResize",value:function(t,e){var r=this.el,n=this.storage,o=this.options,a=o.container,i=o.proportions,s=this.storage,c=s.box,u=s.left,l=s.top,h=s.cw,f=s.ch,p=s.transform,y=s.revX,v=s.revY,d=p.matrix,b=p.scMatrix,m=p.trMatrix,x=p.scaleX,g=p.scaleY,_=c.getBBox(),w=_.width,M=_.height,k=(h+t)/h;if(w=i?h*k:h+t,M=i?f*k:f+e,!(Math.abs(w)<5||Math.abs(M)<5)){var j=w/h,T=M/f;b.a=j,b.b=0,b.c=0,b.d=T,b.e=0,b.f=0,m.e=x,m.f=g;var S=m.multiply(b).multiply(m.inverse()),E=d.multiply(S);r.setAttribute("transform",X(E)),this.storage.cached={scaleX:j,scaleY:T},ct(n,{x:y?u-(w-h):u,y:v?l-(M-f):l,width:w,height:M},a)}}},{key:"_processMove",value:function(t,e){var r=this.options.container,n=this.storage,o=n.transform,a=n.wrapper,i=n.center,s=o.matrix,c=o.trMatrix,u=o.scMatrix,l=o.wrapperMatrix,h=o.parentMatrix;u.e=t,u.f=e;var f=u.multiply(l);a.setAttribute("transform",X(f)),h.e=h.f=0;var p=Vt(h.inverse(),r,t,e),y=p.x,v=p.y;c.e=y,c.f=v;var d=c.multiply(s);if(this.el.setAttribute("transform",X(d)),this.storage.cached={dx:y,dy:v,ox:t,oy:e},i.isShifted){var b=l.inverse();b.e=b.f=0;var m=Vt(b,r,t,e),x=m.x,g=m.y;this._moveCenterHandle(-x,-g)}}},{key:"_processRotate",value:function(t){var e=this.storage,r=e.center,n=e.transform,o=e.wrapper,a=n.matrix,i=n.wrapperMatrix,s=n.parentMatrix,c=n.trMatrix,u=n.scMatrix,l=n.rotMatrix,h=Ot(Math.cos(t)),f=Ot(Math.sin(t));c.e=r.x,c.f=r.y,l.a=h,l.b=f,l.c=-f,l.d=h;var p=c.multiply(l).multiply(c.inverse()).multiply(i);o.setAttribute("transform",X(p)),u.e=r.el_x,u.f=r.el_y,s.e=s.f=0;var y=s.inverse().multiply(l).multiply(s),v=u.multiply(y).multiply(u.inverse()).multiply(a);this.el.setAttribute("transform",X(v))}},{key:"_getState",value:function(t){var e=t.revX,r=t.revY,n=this.el,o=this.storage,a=this.options.container,i=o.box,s=o.wrapper,c=o.parent,u=o.handles.center,l=n.getBBox(),h=l.x,f=l.y,p=l.width,y=l.height,v=i.getBBox(),d=v.width,b=v.height,m=v.x,x=v.y,g=nt(n,c),_=nt(n,a),w=nt(i.parentNode,a),M=nt(c,a),k={matrix:g,ctm:_,boxCTM:w,parentMatrix:M,wrapperMatrix:nt(s,s.parentNode),trMatrix:rt(),scMatrix:rt(),rotMatrix:rt(),scaleX:e?p+h:h,scaleY:r?y+f:f,scX:Math.sqrt(_.a*_.a+_.b*_.b),scY:Math.sqrt(_.c*_.c+_.d*_.d),bBox:l},j=m+d/2,T=x+b/2,S=u?u.cx.baseVal.value:j,E=u?u.cy.baseVal.value:T,A=Vt(w,a,S,E),O=A.x,V=A.y,P=I(u)?Vt(M.inverse(),a,O,V):Vt(g,a,h+p/2,f+y/2),C=P.x,R=P.y,D=Vt(nt(i,a),a,j,T),z=D.x,N=D.y;return lt(n).forEach(function(t){t.__ctm__=nt(t,a)}),{transform:k,cw:d,ch:b,center:{x:u?O:z,y:u?V:N,el_x:C,el_y:R,hx:u?u.cx.baseVal.value:null,hy:u?u.cy.baseVal.value:null,isShifted:Ot(z,3)!==Ot(O,3)&&Ot(N,3)!==Ot(V,3)},left:m,top:x,revX:e,revY:r}}},{key:"_moveCenterHandle",value:function(t,e){var r=this.storage,n=r.handles,o=r.center,a=r.radius;q(n.center)||(n.center.cx.baseVal.value=o.hx+t,n.center.cy.baseVal.value=o.hy+e,a.x2.baseVal.value=o.hx+t,a.y2.baseVal.value=o.hy+e)}},{key:"resetCenterPoint",value:function(){var t=this.storage,e=t.box,r=t.handles,n=t.radius,o=r.center,a=this.options.container,i=e.getBBox(),s=i.width,c=i.height,u=i.x,l=i.y,h=Vt(nt(e,e.parentNode),a,u+s/2,l+c/2),f=h.x,p=h.y;o.cx.baseVal.value=f,o.cy.baseVal.value=p,o.isShifted=!1,n.x2.baseVal.value=f,n.y2.baseVal.value=p}},{key:"controls",get:function(){return this.storage.wrapper}}]),o}();function it(e,t){var r=t.x,n=t.y,o=[];switch(e.tagName.toLowerCase()){case"use":case"image":case"text":case"rect":var a=e.x.baseVal.value+r,i=e.y.baseVal.value+n;o.push(["x",a],["y",i]);break;case"circle":case"ellipse":var s=e.cx.baseVal.value+r,c=e.cy.baseVal.value+n;o.push(["cx",s],["cy",c]);break;case"line":var u=e.x1.baseVal.value+r,l=e.y1.baseVal.value+n,h=e.x2.baseVal.value+r,f=e.y2.baseVal.value+n;o.push(["x1",u],["y1",l],["x2",h],["y2",f]);break;case"polygon":case"polyline":var p=ht(e.getAttribute("points")).map(function(t){return t[0]=Number(t[0])+r,t[1]=Number(t[1])+n,t.join(" ")}).join(" ");o.push(["points",p]);break;case"path":var y=e.getAttribute("d");o.push(["d",function(t){var e=t.path,r=t.dx,n=t.dy;try{for(var o=Rt(e),a="",i=" ",s=!0,c=0,u=o.length;c<u;c++){var l=o[c],h=l.values,f=l.key,p=l.relative,y=[];switch(f){case"M":for(var v=0,d=h.length;v<d;v+=2){var b=Ct(h.slice(v,v+2),2),m=b[0],x=b[1];p&&!s||(m+=r,x+=n),y.push(m,x),s=!1}break;case"A":for(var g=0,_=h.length;g<_;g+=7){var w=h.slice(g,g+7);p||(w[5]+=r,w[6]+=n),y.push.apply(y,$(w))}break;case"C":for(var M=0,k=h.length;M<k;M+=6){var j=h.slice(M,M+6);p||(j[0]+=r,j[1]+=n,j[2]+=r,j[3]+=n,j[4]+=r,j[5]+=n),y.push.apply(y,$(j))}break;case"H":for(var T=0,S=h.length;T<S;T+=1){var E=h.slice(T,T+1);p||(E[0]+=r),y.push(E[0])}break;case"V":for(var A=0,O=h.length;A<O;A+=1){var V=h.slice(A,A+1);p||(V[0]+=n),y.push(V[0])}break;case"L":case"T":for(var P=0,C=h.length;P<C;P+=2){var R=Ct(h.slice(P,P+2),2);m=R[0],x=R[1];p||(m+=r,x+=n),y.push(m,x)}break;case"Q":case"S":for(var D=0,z=h.length;D<z;D+=4){var N=Ct(h.slice(D,D+4),4),X=N[0],Y=N[1],B=N[2],L=N[3];p||(X+=r,Y+=n,B+=r,L+=n),y.push(X,Y,B,L)}break;case"Z":i=h[0]=""}a+=l.cmd+y.join(",")+i}return a}catch(t){At("Path parsing error: "+t)}}({path:y,dx:r,dy:n})])}o.forEach(function(t){e.setAttribute(t[0],t[1])})}function st(e,t){var r=t.scaleX,n=t.scaleY,o=t.bBox,a=t.defaultCTM,i=t.container,s=o.width,c=o.height,u=[],l=nt(e,i),h=a.inverse().multiply(l);switch(e.tagName.toLowerCase()){case"text":var f=e.x.baseVal.value,p=e.y.baseVal.value,y=Vt(h,i,f,p),v=y.x,d=y.y;u.push(["x",v+(r<0?s:0)],["y",d+(n<0?c:0)]);break;case"circle":var b=e.r.baseVal.value,m=e.cx.baseVal.value,x=e.cy.baseVal.value,g=b*(Math.abs(r)+Math.abs(n))/2,_=Vt(h,i,m,x),w=_.x,M=_.y;u.push(["r",g],["cx",w],["cy",M]);break;case"image":case"rect":var k=e.width.baseVal.value,j=e.height.baseVal.value,T=e.x.baseVal.value,S=e.y.baseVal.value,E=Vt(h,i,T,S),A=E.x,O=E.y,V=Math.abs(k*r),P=Math.abs(j*n);u.push(["x",A-(r<0?V:0)],["y",O-(n<0?P:0)],["width",V],["height",P]);break;case"ellipse":var C=e.rx.baseVal.value,R=e.ry.baseVal.value,D=e.cx.baseVal.value,z=e.cy.baseVal.value,N=Vt(h,i,D,z),X=N.x,Y=N.y,B=rt();B.a=r,B.d=n;var L=Vt(B,i,C,R),F=L.x,I=L.y;u.push(["rx",Math.abs(F)],["ry",Math.abs(I)],["cx",X],["cy",Y]);break;case"line":var q=e.x1.baseVal.value,U=e.y1.baseVal.value,G=e.x2.baseVal.value,H=e.y2.baseVal.value,Q=Vt(h,i,q,U),Z=Q.x,$=Q.y,J=Vt(h,i,G,H),K=J.x,W=J.y;u.push(["x1",Z],["y1",$],["x2",K],["y2",W]);break;case"polygon":case"polyline":var tt=ht(e.getAttribute("points")).map(function(t){var e=Vt(h,i,Number(t[0]),Number(t[1])),r=e.x,n=e.y;return t[0]=r,t[1]=n,t.join(" ")}).join(" ");u.push(["points",tt]);break;case"path":var et=e.getAttribute("d");u.push(["d",function(t){var e=t.path,r=t.localCTM,n=t.container;try{for(var o=Rt(e),a="",i=" ",s=[],c=!0,u=0,l=o.length;u<l;u++){var h=o[u],f=h.values,p=h.key,y=h.relative;switch(p){case"A":for(var v=[],d=0,b=f.length;d<b;d+=7){var m=Ct(f.slice(d,d+7),7),x=m[0],g=m[1],_=m[2],w=m[3],M=m[4],k=m[5],j=m[6],T=Pt(r);y&&(T.e=T.f=0);var S=Vt(T,n,k,j),E=S.x,A=S.y;v.push(Ot(E),Ot(A)),T.e=T.f=0;var O=Vt(T,n,x,g),V=O.x,P=O.y;v.unshift(Ot(V),Ot(P),_,w,M)}s.push(v);break;case"C":for(var C=[],R=0,D=f.length;R<D;R+=6){var z=Ct(f.slice(R,R+6),6),N=z[0],X=z[1],Y=z[2],B=z[3],L=(k=z[4],j=z[5],Pt(r));y&&(L.e=L.f=0);var F=Vt(L,n,N,X),I=F.x,q=F.y,U=Vt(L,n,Y,B),G=U.x,H=U.y,Q=Vt(L,n,k,j);E=Q.x,A=Q.y;C.push(Ot(I),Ot(q),Ot(G),Ot(H),Ot(E),Ot(A))}s.push(C);break;case"H":for(var Z=[],$=0,J=f.length;$<J;$+=1){k=Ct(f.slice($,$+1),1)[0];var K=Pt(r);y&&(K.e=K.f=0);E=Vt(K,n,k,0).x;Z.push(Ot(E))}s.push(Z);break;case"V":for(var W=[],tt=0,et=f.length;tt<et;tt+=1){j=Ct(f.slice(tt,tt+1),1)[0];var rt=Pt(r);y&&(rt.e=rt.f=0);A=Vt(rt,n,0,j).y;W.push(Ot(A))}s.push(W);break;case"T":case"L":for(var nt=[],ot=0,at=f.length;ot<at;ot+=2){var it=Ct(f.slice(ot,ot+2),2),st=(k=it[0],j=it[1],Pt(r));y&&(st.e=st.f=0);var ct=Vt(st,n,k,j);E=ct.x,A=ct.y;nt.push(Ot(E),Ot(A))}s.push(nt);break;case"M":for(var ut=[],lt=0,ht=f.length;lt<ht;lt+=2){var ft=Ct(f.slice(lt,lt+2),2),pt=(k=ft[0],j=ft[1],Pt(r));y&&!c&&(pt.e=pt.f=0);var yt=Vt(pt,n,k,j);E=yt.x,A=yt.y;ut.push(Ot(E),Ot(A)),c=!1}s.push(ut);break;case"Q":for(var vt=[],dt=0,bt=f.length;dt<bt;dt+=4){var mt=Ct(f.slice(dt,dt+4),4),xt=(N=mt[0],X=mt[1],k=mt[2],j=mt[3],Pt(r));y&&(xt.e=xt.f=0);var gt=Vt(xt,n,N,X),_t=(I=gt.x,q=gt.y,Vt(xt,n,k,j));E=_t.x,A=_t.y;vt.push(Ot(I),Ot(q),Ot(E),Ot(A))}s.push(vt);break;case"S":for(var wt=[],Mt=0,kt=f.length;Mt<kt;Mt+=4){var jt=Ct(f.slice(Mt,Mt+4),4),Tt=(Y=jt[0],B=jt[1],k=jt[2],j=jt[3],Pt(r));y&&(Tt.e=Tt.f=0);var St=Vt(Tt,n,Y,B),Et=(G=St.x,H=St.y,Vt(Tt,n,k,j));E=Et.x,A=Et.y;wt.push(Ot(G),Ot(H),Ot(E),Ot(A))}s.push(wt);break;case"Z":s.push([""]),i=""}a+=h.cmd+s[u].join(",")+i}return a}catch(t){At("Path parsing error: "+t)}}({path:et,localCTM:h,container:i})])}u.forEach(function(t){e.setAttribute(t[0],t[1])})}function ct(t,e,r){var n=t.box,o=t.handles,a=t.normalLine,i=t.radius,s=t.center,c=e.x,u=e.y,l=e.width,h=e.height,f=l/2,p=h/2,y=nt(n,n.parentNode),v=Vt(y,r,c+f,u+p),d={tl:Vt(y,r,c,u),tr:Vt(y,r,c+l,u),br:Vt(y,r,c+l,u+h),bl:Vt(y,r,c,u+h),tc:Vt(y,r,c+f,u),bc:Vt(y,r,c+f,u+h),ml:Vt(y,r,c,u+p),mr:Vt(y,r,c+l,u+p),rotator:{},center:!s.isShifted&&I(o.center)?v:void 0},b=Math.atan2(d.tl.y-d.tr.y,d.tl.x-d.tr.x);d.rotator.x=d.mr.x-50*Math.cos(b),d.rotator.y=d.mr.y-50*Math.sin(b),a.x1.baseVal.value=d.mr.x,a.y1.baseVal.value=d.mr.y,a.x2.baseVal.value=d.rotator.x,a.y2.baseVal.value=d.rotator.y,I(i)&&(i.x1.baseVal.value=v.x,i.y1.baseVal.value=v.y,s.isShifted||(i.x2.baseVal.value=v.x,i.y2.baseVal.value=v.y));var m={x:c+=l<0?l:0,y:u+=h<0?h:0,width:Math.abs(l),height:Math.abs(h)};Object.keys(m).forEach(function(t){n.setAttribute(t,m[t])}),Object.keys(d).forEach(function(t){var e=o[t],r=d[t];q(r)||(e.setAttribute("cx",r.x),e.setAttribute("cy",r.y))})}function ut(t){return"g"===t.tagName.toLowerCase()}function lt(t){var r=[];return ut(t)?n.call(t.childNodes,function(t){if(1===t.nodeType){var e=t.tagName.toLowerCase();-1!==A.indexOf(e)&&("g"===e&&r.push.apply(r,L(lt(t))),r.push(t))}}):r.push(t),r}function ht(t){return t.match(ot).reduce(function(t,e,r,n){return r%2==0&&t.push(n.slice(r,r+2)),t},[])}function ft(t,e){t.setAttribute("stroke",e),t.setAttribute("stroke-dasharray","3 3"),t.setAttribute("vector-effect","non-scaling-stroke")}function pt(r,t){if(this.length){var n=I(t)&&t instanceof y?t:new y;return s.call(this,function(t,e){return e instanceof SVGElement?function(t){var e=t.tagName.toLowerCase();return-1!==A.indexOf(e)||(At("Selected element is not allowed to transform. Allowed elements:\ncircle, ellipse, image, line, path, polygon, polyline, rect, text, g"),!1)}(e)&&t.push(new at(e,r,n)):t.push(new j(e,r,n)),t},[])}}function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var dt=function(){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.el=t,this.options=e||{},this.storage=null,this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._animate=this._animate.bind(this),this.enable()}return function(t,e,r){e&&vt(t.prototype,e),r&&vt(t,r)}(r,[{key:"enable",value:function(){q(this.storage)?this._init():At("Already enabled")}},{key:"disable",value:function(){this._destroy()}},{key:"_init",value:function(){var t=this,e=t.el,r=t.options,n=U(e),o=r.style,a=r.onDrop,i=r.appendTo,s=r.stack,c={position:"absolute","z-index":"2147483647",style:I(o)&&"object"===yt(o)?o:void 0},u=I(s)?U(s)[0]:document,l=h(a)?function(t){var e=this.storage.clone;!function(t,e){var r=V(t),n=r.top,o=r.left,a=V(e),i=a.top,s=a.left,c=U(t),u=U(e);return!(n<i||n+parseFloat(c.css("height"))>i+parseFloat(u.css("height"))||o<s||o+parseFloat(c.css("width"))>s+parseFloat(u.css("width")))}(e,u)||a.call(this,t,this.el,e)}:function(){};t.storage={onDrop:l,options:r,css:c,parent:I(i)?U(i)[0]:document.body,stack:u},n.on("mousedown",t._onMouseDown).on("touchstart",t._onTouchStart)}},{key:"_start",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,r=this.el,n=e.parent,o=e.css,a=V(n),i=t.clientX,s=t.clientY;o.left="".concat(i-a.left,"px"),o.top="".concat(s-a.top,"px");var c=r.cloneNode(!0);U(c).css(o),e.clientX=i,e.clientY=s,e.cx=i,e.cy=s,e.clone=c,U(n)[0].appendChild(c),this._draw()}},{key:"_move",value:function(t){t.preventDefault&&t.preventDefault();var e=this.storage;e.clientX=t.clientX,e.clientY=t.clientY,e.doDraw=!0,e.doMove=!0}},{key:"_end",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,r=e.clone,n=e.frameId,o=e.onDrop;e.doDraw=!1,i(n),q(r)||(o.call(this,t),r.parentNode.removeChild(r),delete e.clone)}},{key:"_draw",value:function(){this._animate()}},{key:"_animate",value:function(){var t=this.storage;t.frameId=F(this._animate);var e=t.doDraw,r=t.clientX,n=t.clientY,o=t.cx,a=t.cy,i=t.clone;if(e){t.doDraw=!1;var s="translate(".concat(r-o,"px, ").concat(n-a,"px)");U(i).css({transform:s,webkitTranform:s,mozTransform:s,msTransform:s,otransform:s})}}},{key:"_destroy",value:function(){q(this.storage)||(U(this.el).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart),delete this.storage)}},{key:"_onMouseDown",value:function(t){this._start(t),U(document).on("mousemove",this._onMouseMove).on("mouseup",this._onMouseUp)}},{key:"_onMouseMove",value:function(t){this._move(t)}},{key:"_onMouseUp",value:function(t){this._end(t),U(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp)}},{key:"_onTouchStart",value:function(t){this._start(t.touches[0]),U(document).on("touchmove",this._onTouchMove).on("touchend",this._onTouchEnd)}},{key:"_onTouchMove",value:function(t){this._move(t.touches[0])}},{key:"_onTouchEnd",value:function(t){0===t.touches.length&&this._end(t.changedTouches[0]),U(document).off("touchmove",this._onTouchMove).off("touchend",this._onTouchEnd)}}]),r}();function bt(e){if(this.length)return a.call(this,function(t){return new dt(t,e)})}function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gt(t,e){return!e||"object"!==mt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wt(t,e){return(wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mt=function(){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),gt(this,_t(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(e,l),function(t,e,r){e&&xt(t.prototype,e),r&&xt(t,r)}(e,[{key:"drag",value:function(){return pt.call.apply(pt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"clone",value:function(){return bt.call.apply(bt,[this].concat(Array.prototype.slice.call(arguments)))}}]),e}();
/* @license
 * Move/Rotate/Resize tool
 * Released under the MIT license, 2018-2019
 * Karen Sarksyan
 * nichollascarter@gmail.com
*/
function kt(t){return new Mt(t)}r.d(e,"default",function(){return kt}),r.d(e,"Subjx",function(){return Mt}),r.d(e,"Observable",function(){return y}),Object.defineProperty(kt,"createObservable",{value:function(){return new y}})}]);